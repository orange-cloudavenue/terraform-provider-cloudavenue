# --------------------------------------------------------------
# WARNING: This file is managed by centralized sync management system.
# Do not edit this file directly, your changes will be overwritten.
# See https://github.com/orange-cloudavenue/workflows for more information.
# --------------------------------------------------------------
name: PR All events

on:
  pull_request:
    types: [ opened, reopened, synchronize, edited ]


concurrency:
  group: ${{ github.ref }}-${{ github.head_ref }}-pr-all
  cancel-in-progress: true

permissions:
  contents: write
  pull-requests: write

jobs:
  changelog-dependabot:
    name: "Changelog Dependabot"
    uses: orange-cloudavenue/workflows/.github/workflows/changelog_dependabot.yml@main
    secrets:
      TOKEN: ${{ secrets.GITHUB_TOKEN }}

  
      

  pr-size:
    if: github.event.action != 'edited'
    name: "PR Size"
    uses: orange-cloudavenue/workflows/.github/workflows/pr_label_size.yml@main
    with:
      ref: ${{ github.ref }}
      repository: ${{ github.repository }}
    secrets:
      TOKEN: ${{ secrets.CHANGELOG_PAT }}

  pr-conventional-commits:
    name: "Conventional Commits"
    uses: orange-cloudavenue/workflows/.github/workflows/pr_conventional_commits.yml@main
    secrets:
      TOKEN: ${{ secrets.CHANGELOG_PAT }}

  pr-license:
    if: github.event.action != 'edited' && github.event.pull_request.draft == false
    name: "License Check"
    uses: orange-cloudavenue/workflows/.github/workflows/pr_license.yml@main
    with:
      ref: ${{ github.ref }}
      repository: ${{ github.repository }}

  golang-ci-lint:
    if: github.event.action != 'edited' && github.event.pull_request.draft == false
    name: "Lint"
    uses: orange-cloudavenue/workflows/.github/workflows/go_golangci-lint.yml@main
    with:
      ref: ${{ github.ref }}
      repository: ${{ github.repository }}

  tests:
    if: github.event.action != 'edited' && github.event.pull_request.draft == false
    name: "Unit Tests"
    uses: orange-cloudavenue/workflows/.github/workflows/go_unit-test-tf-provider.yml@main
    with:
        ref: ${{ github.ref }}
        repository: ${{ github.repository }}
    secrets:
        CLOUDAVENUE_ORG: ${{ secrets.CLOUDAVENUE_ORG }}
        CLOUDAVENUE_USER: ${{ secrets.CLOUDAVENUE_USER }}
        CLOUDAVENUE_PASSWORD: ${{ secrets.CLOUDAVENUE_PASSWORD }}
        CLOUDAVENUE_VDC: ${{ secrets.CLOUDAVENUE_VDC }}
