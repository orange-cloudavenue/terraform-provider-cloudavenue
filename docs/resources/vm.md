---
page_title: "cloudavenue_vm Resource - cloudavenue"
subcategory: "VM (Virtual Machine)"
description: |-
  The virtual machine (vm) resource allows you to manage a virtual machine in the CloudAvenue.
---

# cloudavenue_vm (Resource)

The virtual machine (vm) resource allows you to manage a virtual machine in the CloudAvenue.

## Examples

~> **Warning**
Due BUG in Terraform Framework, the **resource** and **state** block must be defined, even if empty.

### Minimal setup

This example shows how to create a simple VM.
The VM inherits resources from the template.

```hcl
data "cloudavenue_catalog_vapp_template" "example" {
  catalog_name  = "Orange-Linux"
  template_name = "debian_10_X64"
}

resource "cloudavenue_vapp" "example" {
  name        = "example-vapp"
  description = "This is an example vApp"
}

resource "cloudavenue_vm" "example" {
    name        = "example-vm"
    description = "This is a example vm"
    vapp_name = cloudavenue_vapp.example.name
    deploy_os = {
      vapp_template_id = data.cloudavenue_catalog_vapp_template.example.id
    }
    settings = {
        customization = {
            auto_generate_password = true
        }
    }
    resource = {}
    state = {}
}
```

### VM with template

This example shows how to create a VM from a vApp template.

```hcl
data "cloudavenue_catalog_vapp_template" "example" {
  catalog_name  = "Orange-Linux"
  template_name = "debian_10_X64"
}

resource "cloudavenue_vapp" "example" {
  name        = "example-vapp"
  description = "This is an example vApp"
}

resource "cloudavenue_vm" "example" {
  name        = "example-vm"
  description = "This is a example vm"
  vapp_name = cloudavenue_vapp.example.name
  deploy_os = {
    vapp_template_id = data.cloudavenue_catalog_vapp_template.example.id
    accept_all_eulas = true
  }
  state = {
    power_on = false
  }
  resource = {
    cpus   = 4
    memory = 4096
  }
}  
```

### VM with ISO

This example shows how to create a VM from an ISO file with a disk size of 20G.

```hcl
data "cloudavenue_catalog_media" "example" {
  catalog_name = "example-catalog"
  name         = "debian-9.9.0-amd64-netinst.iso"
}

resource "cloudavenue_vapp" "example" {
  name        = "example-vapp"
  description = "This is an example vApp"
}

resource "cloudavenue_vm" "example-iso" {
  name      = "example-vm-iso"
  vapp_name = cloudavenue_vapp.example.name
  deploy_os = {
    boot_image_id = data.cloudavenue_catalog_media.example.id
  }
  settings = {
    customization = {
      auto_generate_password = true
    }
    os_type = "debian10_64Guest"
  }
  resource = {
    cpus   = 2
    memory = 2048
  }

  state = {
    power_on = false
  }
}

resource "cloudavenue_vm_disk" "example" {
  vapp_id       = cloudavenue_vapp.example.id
  bus_type      = "SATA"
  size_in_mb    = 20480
  is_detachable = false
  vm_id         = cloudavenue_vm.example-iso.id
}
```

-> **Advanced Examples**
See below for [Advanced VM Examples](#advanced--examples).

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) (ForceNew) The name of the VM. Unique within the vApp. Must be between 1 and 80 characters long and can contain only letters, numbers and hyphen. It must not contain only digits.

### Optional

- `deploy_os` (Attributes) . (see [below for nested schema](#nestedatt--deploy_os))
- `description` (String) The description of the VM.
- `resource` (Attributes) The resource of the VM. (see [below for nested schema](#nestedatt--resource))
- `settings` (Attributes) The settings for the VM. (see [below for nested schema](#nestedatt--settings))
- `state` (Attributes) The state of the VM. (see [below for nested schema](#nestedatt--state))
- `vapp_id` (String) (ForceNew) The vApp this VM belongs to. Ensure that one and only one attribute from this collection is set : `vapp_name`, `vapp_id`.
- `vapp_name` (String) (ForceNew) The vApp this VM belongs to. Ensure that one and only one attribute from this collection is set : `vapp_name`, `vapp_id`.
- `vdc` (String) (ForceNew) The name of vDC to use, optional if defined at provider level.

### Read-Only

- `id` (String) The ID of the VM.

<a id="nestedatt--deploy_os"></a>
### Nested Schema for `deploy_os`

Optional:

- `accept_all_eulas` (Boolean) Automatically accept EULA if OVA has it. Value defaults to `true`.
- `boot_image_id` (String) (ForceNew) The ID of the boot image to use for the VM. Ensure that if an attribute is set, these are not set: "[<.vapp_template_id]".
- `vapp_template_id` (String) (ForceNew) The ID of the vApp template to use for the VM. Ensure that if an attribute is set, these are not set: "[<.boot_image_id]".
- `vm_name_in_template` (String) (ForceNew) The name of the VM in the vApp template. Ensure that if an attribute is set, these are not set: "[<.boot_image_id]".


<a id="nestedatt--resource"></a>
### Nested Schema for `resource`

Optional:

- `cpu_hot_add_enabled` (Boolean) Whether CPU hot add is enabled or not. Value defaults to `true`.
- `cpus` (Number) The number of virtual CPUs to allocate to the VM. Value must be at most 256. Value defaults to `1`.
- `cpus_cores` (Number) The number of cores per virtual CPU to allocate to the VM. All the possibilities of dividing the value of attribute <.cpus by an integer. Value defaults to `1`.
- `memory` (Number) The amount of memory to allocate to the VM, in MB. This attribute needs to be divisible by 4 with zero remainder. Value defaults to `1024`.
- `memory_hot_add_enabled` (Boolean) Whether memory hot add is enabled or not. Value defaults to `true`.
- `networks` (Attributes List) The networks to attach to the VM. (see [below for nested schema](#nestedatt--resource--networks))

<a id="nestedatt--resource--networks"></a>
### Nested Schema for `resource.networks`

Required:

- `type` (String) The type of network to attach to the VM. Value must be one of: `vapp` (A vApp network. This network is only available in your vApp structure.), `org` (An organization network. This network can be a network isolated or routed in your Organization.), `none` (No network.).

Optional:

- `adapter_type` (String) The type of vNic to create on this interface. Value must be one of: `VMXNET3` (A VMXNET3 adapter it's an paravirtualized NIC designed for performance. VMXNET 3 offers all the features available in VMXNET 2 and adds several new features.), `E1000E` (A E1000E adapter it's an Emulated version of the Intel 82574 Gigabit Ethernet NIC. E1000E is the default adapter for Windows 8 and Windows Server 2012.), `VMXNET3VRDMA` (VMXNET3VRDMA adapter it's a paravirtualized NIC that supports remote direct memory access (RDMA) between virtual machines through the OFED verbs API.), `SRIOVETHERNETCARD` (SRIOVETHERNETCARD adapter it's a representation of a virtual function (VF) on a physical NIC with SR-IOV support.). Value defaults to `VMXNET3`.
- `connected` (Boolean) Whether the network interface is connected or not. Value defaults to `true`.
- `ip` (String) The IP address to assign to this VM on this network. Must be a valid IP with net.ParseIP. If <.ip_allocation_mode attribute is set and the value is one of `"MANUAL"`, `"POOL"`, this attribute is REQUIRED. If <.ip_allocation_mode attribute is set and the value is one of `"DHCP"`, `"NONE"`, this attribute is NULL.
- `ip_allocation_mode` (String) The IP allocation mode for this network. Value must be one of : `DHCP`, `POOL`, `MANUAL`, `NONE`. Value defaults to `DHCP`.
- `is_primary` (Boolean) Whether this network is the primary network for the VM. Value defaults to `false`.
- `mac` (String) The MAC address to assign to this VM on this network. Autogenerated if not specified. Must be a valid mac address.
- `name` (String) The name of the network to attach to the VM. If <.type attribute is set and the value is one of `"vapp"`, `"org"`, this attribute is REQUIRED. If <.type attribute is set and the value is one of `"none"`, this attribute is NULL.



<a id="nestedatt--settings"></a>
### Nested Schema for `settings`

Optional:

- `affinity_rule_id` (String) The ID of the affinity rule to apply to this VM.
- `customization` (Attributes) The customization settings for the VM. (see [below for nested schema](#nestedatt--settings--customization))
- `expose_hardware_virtualization` (Boolean) Whether to expose hardware CPU virtualization to the guest OS. Value defaults to `false`.
- `guest_properties` (Map of String) Key/Value settings for guest properties.
- `os_type` (String) The type of OS installed on the VM. Value must be one of : `amazonlinux2_64Guest`, `asianux3Guest`, `asianux3_64Guest`, `asianux4Guest`, `asianux4_64Guest`, `asianux7_64Guest`, `asianux8_64Guest`, `centos64Guest`, `centos6Guest`, `centos6_64Guest`, `centos7_64Guest`, `centos8_64Guest`, `centosGuest`, `coreos64Guest`, `darwin10Guest`, `darwin10_64Guest`, `darwin11Guest`, `darwin11_64Guest`, `darwin12_64Guest`, `darwin13_64Guest`, `darwin14_64Guest`, `darwin15_64Guest`, `darwin16_64Guest`, `darwin17_64Guest`, `darwin18_64Guest`, `debian10Guest`, `debian10_64Guest`, `debian4Guest`, `debian4_64Guest`, `debian5Guest`, `debian5_64Guest`, `debian6Guest`, `debian6_64Guest`, `debian7Guest`, `debian7_64Guest`, `debian8Guest`, `debian8_64Guest`, `debian9Guest`, `debian9_64Guest`, `dosGuest`, `eComStation2Guest`, `eComStationGuest`, `freebsd11Guest`, `freebsd11_64Guest`, `freebsd12Guest`, `freebsd12_64Guest`, `freebsd64Guest`, `freebsdGuest`, `netware5Guest`, `netware6Guest`, `oesGuest`, `openServer5Guest`, `openServer6Guest`, `oracleLinux64Guest`, `oracleLinux6Guest`, `oracleLinux6_64Guest`, `oracleLinux7_64Guest`, `oracleLinux8_64Guest`, `oracleLinuxGuest`, `os2Guest`, `other24xLinux64Guest`, `other24xLinuxGuest`, `other26xLinux64Guest`, `other26xLinuxGuest`, `other3xLinux64Guest`, `other3xLinuxGuest`, `other4xLinux64Guest`, `other4xLinuxGuest`, `otherGuest`, `otherGuest64`, `otherLinux64Guest`, `otherLinuxGuest`, `rhel2Guest`, `rhel3Guest`, `rhel3_64Guest`, `rhel4Guest`, `rhel4_64Guest`, `rhel5Guest`, `rhel5_64Guest`, `rhel6Guest`, `rhel6_64Guest`, `rhel7_64Guest`, `rhel8_64Guest`, `sles10Guest`, `sles10_64Guest`, `sles11Guest`, `sles11_64Guest`, `sles12_64Guest`, `sles15_64Guest`, `sles64Guest`, `slesGuest`, `solaris10Guest`, `solaris10_64Guest`, `solaris11_64Guest`, `ubuntu64Guest`, `ubuntuGuest`, `unixWare7Guest`, `vmwarePhoton64Guest`, `win2000AdvServGuest`, `win2000ProGuest`, `win2000ServGuest`, `win31Guest`, `win95Guest`, `win98Guest`, `winLonghorn64Guest`, `winLonghornGuest`, `winNTGuest`, `winNetBusinessGuest`, `winNetDatacenter64Guest`, `winNetDatacenterGuest`, `winNetEnterprise64Guest`, `winNetEnterpriseGuest`, `winNetStandard64Guest`, `winNetStandardGuest`, `winNetWebGuest`, `winVista64Guest`, `winVistaGuest`, `winXPPro64Guest`, `winXPProGuest`, `windows7Guest`, `windows7Server64Guest`, `windows7_64Guest`, `windows8Guest`, `windows8Server64Guest`, `windows8_64Guest`, `windows9Guest`, `windows9_64Guest`.
- `storage_profile` (String) The storage profile to use. Value must be one of : `silver`, `silver_r1`, `silver_r2`, `gold`, `gold_r1`, `gold_r2`, `gold_hm`, `platinum3k`, `platinum3k_r1`, `platinum3k_r2`, `platinum3k_hm`, `platinum7k`, `platinum7k_r1`, `platinum7k_r2`, `platinum7k_hm`.

<a id="nestedatt--settings--customization"></a>
### Nested Schema for `settings.customization`

Optional:

- `admin_password` (String, Sensitive) The admin password for the VM. Ensure that one and only one attribute from this collection is set : `admin_password`, `auto_generate_password`.
- `allow_local_admin_password` (Boolean) Whether to allow the local admin password to be changed.
- `auto_generate_password` (Boolean) Whether to auto-generate the password. Ensure that one and only one attribute from this collection is set : `admin_password`, `auto_generate_password`.
- `change_sid` (Boolean) Whether to change the SID of the VM. Applicable only for Windows VMs.
- `enabled` (Boolean) Whether guest customization is enabled or not. Value defaults to `false`.
- `force` (Boolean) `true` value will cause the VM to reboot on every `apply` operation.
- `hostname` (String) Computer name to assign to this virtual machine. Default is the value of attribute `name`. Must be between 1 and 80 characters long and can contain only letters, numbers and hyphen. It must not contain only digits.
- `init_script` (String) The init script to run.
- `join_domain` (Boolean) Enable this VM to join a domain.
- `join_domain_account_ou` (String) The domain account OU to join.
- `join_domain_name` (String) The domain name to join.
- `join_domain_password` (String, Sensitive) The domain password to join.
- `join_domain_user` (String) The domain user to join.
- `join_org_domain` (Boolean) Use organization's domain for joining.
- `must_change_password_on_first_login` (Boolean) .
- `number_of_auto_logons` (Number) The number of times the VM should auto-login. Value must be at least 0.



<a id="nestedatt--state"></a>
### Nested Schema for `state`

Optional:

- `power_on` (Boolean) Whether the VM should be powered on or not. `true` means powered on, `false` means powered off. Value defaults to `true`.

Read-Only:

- `status` (String) The status of the VM.



<a id="advanced--examples"></a>
## Advanced Examples


### VM with Network

This example shows how to create a VM from a vApp template connected to a routed network.

```hcl
data "cloudavenue_tier0_vrfs" "example" {}

resource "cloudavenue_edgegateway" "example" {
  owner_name     = "example-vdc"
  tier0_vrf_name = data.cloudavenue_tier0_vrfs.example.names.0
  owner_type     = "vdc"
}

resource "cloudavenue_network_routed" "example" {
  name        = "example-network"
  description = "This is an example Net"
  edge_gateway_id = cloudavenue_edgegateway.example.id
  gateway       = "192.168.1.254"
  prefix_length = 24
  dns1 = "1.1.1.1"
  dns2 = "8.8.8.8"
  dns_suffix = "example"
  static_ip_pool = [
    {
      start_address = "192.168.1.10"
      end_address   = "192.168.1.20"
    }
  ]
}

resource "cloudavenue_vapp" "example" {
  name        = "example-vapp"
  description = "This is an example vApp"
}

resource "cloudavenue_vapp_org_network" "example" {
  vapp_name    = cloudavenue_vapp.example.name
  network_name = cloudavenue_network_routed.example.name
}

resource "cloudavenue_vm" "example" {
  name      = "example-vm"
  vapp_name = cloudavenue_vapp.example.name
  deploy_os = {
    vapp_template_id = data.cloudavenue_catalog_vapp_template.example.id
  }
  settings = {
    guest_properties = {
      "guestinfo.hostname" = "example-vm"
    }
    customization = {
      auto_generate_password = true
    }
  }
  resource = {
    cpus   = 2
    memory = 2048
    networks = [
      {
        type               = "org"
        name               = cloudavenue_vapp_org_network.example.network_name
        ip                 = "192.168.1.11"
        ip_allocation_mode = "MANUAL"
        is_primary         = true
      }
    ]
  }
}
```