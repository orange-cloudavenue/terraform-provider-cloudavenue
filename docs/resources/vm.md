---
page_title: "cloudavenue_vm Resource - cloudavenue"
subcategory: "VM (Virtual Machine)"
description: |-
  The virtual machine (vm) resource allows you to manage a virtual machine in the CloudAvenue.
---

# cloudavenue_vm (Resource)

The virtual machine (vm) resource allows you to manage a virtual machine in the CloudAvenue.

## Examples

~> **Warning**
Due to a BUG in Terraform Framework, the **resource** and **state** block must be defined, even if empty.

### Minimal setup

This example shows how to create a simple VM.
The VM inherits resources from the template.

```hcl
data "cloudavenue_catalog_vapp_template" "example" {
  catalog_name  = "Orange-Linux"
  template_name = "debian_10_X64"
}

resource "cloudavenue_vapp" "example" {
  name        = "example-vapp"
  description = "This is an example vApp"
}

resource "cloudavenue_vm" "example" {
    name        = "example-vm"
    description = "This is a example vm"
    vapp_name = cloudavenue_vapp.example.name
    deploy_os = {
      vapp_template_id = data.cloudavenue_catalog_vapp_template.example.id
    }
    settings = {
        customization = {
            auto_generate_password = true
        }
    }
    resource = {}
    state = {}
}
```

### VM with template

This example shows how to create a VM from a vApp template.

```hcl
data "cloudavenue_catalog_vapp_template" "example" {
  catalog_name  = "Orange-Linux"
  template_name = "debian_10_X64"
}

resource "cloudavenue_vapp" "example" {
  name        = "example-vapp"
  description = "This is an example vApp"
}

resource "cloudavenue_vm" "example" {
  name        = "example-vm"
  description = "This is a example vm"
  vapp_name = cloudavenue_vapp.example.name
  deploy_os = {
    vapp_template_id = data.cloudavenue_catalog_vapp_template.example.id
    accept_all_eulas = true
  }
  state = {
    power_on = false
  }
  resource = {
    cpus   = 4
    memory = 4096
  }
}  
```

### VM with ISO

This example shows how to create a VM from an ISO file with a disk size of 20G.

```hcl
data "cloudavenue_catalog_media" "example" {
  catalog_name = "example-catalog"
  name         = "debian-9.9.0-amd64-netinst.iso"
}

resource "cloudavenue_vapp" "example" {
  name        = "example-vapp"
  description = "This is an example vApp"
}

resource "cloudavenue_vm" "example-iso" {
  name      = "example-vm-iso"
  vapp_name = cloudavenue_vapp.example.name
  deploy_os = {
    boot_image_id = data.cloudavenue_catalog_media.example.id
  }
  settings = {
    customization = {
      auto_generate_password = true
    }
    os_type = "debian10_64Guest"
  }
  resource = {
    cpus   = 2
    memory = 2048
  }

  state = {
    power_on = false
  }
}

resource "cloudavenue_vm_disk" "example" {
  vapp_id       = cloudavenue_vapp.example.id
  bus_type      = "SATA"
  size_in_mb    = 20480
  is_detachable = false
  vm_id         = cloudavenue_vm.example-iso.id
}
```

-> **Advanced Examples**
See below for [Advanced VM Examples](#advanced--examples).

## Restart Required

<a id="restartrequired"></a>

~> **Some attributes changes require VM restart**
In this case, Terraform will report a difference to be applied, and will restart the VM.
The attributes is marked with the following text: **(Restart Required)**

~> **Cpu and Memory changes**
If you change the number of CPUs or the amount of memory and cpu/memory hotplug is not enabled, the VM will be restarted.

~> **Network changes**
If your change network card is primary, the VM will be restarted.

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) (ForceNew) The name of the VM. Unique within the vApp. Must be between 1 and 80 characters long and can contain only letters, numbers and hyphen. It must not contain only digits.

### Optional

- `deploy_os` (Attributes) Settings for deploying the operating system on the VM. (see [below for nested schema](#nestedatt--deploy_os))
- `description` (String) The description of the VM <a href="#restartrequired" style="color:red">(Restart Required)</a>.
- `resource` (Attributes) The resource of the VM. (see [below for nested schema](#nestedatt--resource))
- `settings` (Attributes) The settings for the VM. (see [below for nested schema](#nestedatt--settings))
- `state` (Attributes) The state of the VM. (see [below for nested schema](#nestedatt--state))
- `vapp_id` (String) (ForceNew) The vApp this VM belongs to. Ensure that one and only one attribute from this collection is set : `vapp_name`, `vapp_id`.
- `vapp_name` (String) (ForceNew) The vApp this VM belongs to. Ensure that one and only one attribute from this collection is set : `vapp_name`, `vapp_id`.
- `vdc` (String) (ForceNew) The name of vDC to use, optional if defined at provider level.

### Read-Only

- `id` (String) The ID of the VM.

<a id="nestedatt--deploy_os"></a>
### Nested Schema for `deploy_os`

Optional:

- `accept_all_eulas` (Boolean) Automatically accept EULA if OVA has it.
- `boot_image_id` (String) (ForceNew) The ID of the boot image to use for the VM. Ensure that if an attribute is set, these are not set: "[<.vapp_template_id]".
- `vapp_template_id` (String) (ForceNew) The ID of the vApp template to use for the VM. Ensure that if an attribute is set, these are not set: "[<.boot_image_id]".
- `vm_name_in_template` (String) (ForceNew) The name of the VM in the vApp template. Ensure that if an attribute is set, these are not set: "[<.boot_image_id]".


<a id="nestedatt--resource"></a>
### Nested Schema for `resource`

Optional:

- `cpu_hot_add_enabled` (Boolean) Whether CPU hot add is enabled or not <a href="#restartrequired" style="color:red">(Restart Required)</a>. Value defaults to `true`.
- `cpus` (Number) The number of virtual CPUs to allocate to the VM. <a href="#restartrequired" style="color:red">(Restart Required)</a>. Value must be at most 256. Value defaults to `1`.
- `cpus_cores` (Number) The number of cores per virtual CPU to allocate to the VM. <a href="#restartrequired" style="color:red">(Restart Required)</a>. All the possibilities of dividing the value of attribute <.cpus by an integer. Value defaults to `1`.
- `memory` (Number) The amount of memory to allocate to the VM, in MB. <a href="#restartrequired" style="color:red">(Restart Required)</a>. This attribute needs to be divisible by 4 with zero remainder. Value defaults to `1024`.
- `memory_hot_add_enabled` (Boolean) Whether memory hot add is enabled or not. <a href="#restartrequired" style="color:red">(Restart Required)</a>. Value defaults to `true`.
- `networks` (Attributes List) The networks to attach to the VM. <a href="#restartrequired" style="color:red">(Restart Required)</a>. (see [below for nested schema](#nestedatt--resource--networks))

<a id="nestedatt--resource--networks"></a>
### Nested Schema for `resource.networks`

Required:

- `type` (String) The type of network to attach to the VM. Value must be one of: `vapp` (A vApp network. This network is only available in your vApp structure.), `org` (An organization network. This network can be a network isolated or routed in your Organization.), `none` (No network.).

Optional:

- `adapter_type` (String) The type of vNic to create on this interface. Value must be one of: `VMXNET3` (A VMXNET3 adapter it's an paravirtualized NIC designed for performance. VMXNET 3 offers all the features available in VMXNET 2 and adds several new features.), `E1000E` (A E1000E adapter it's an Emulated version of the Intel 82574 Gigabit Ethernet NIC. E1000E is the default adapter for Windows 8 and Windows Server 2012.), `VMXNET3VRDMA` (VMXNET3VRDMA adapter it's a paravirtualized NIC that supports remote direct memory access (RDMA) between virtual machines through the OFED verbs API.), `SRIOVETHERNETCARD` (SRIOVETHERNETCARD adapter it's a representation of a virtual function (VF) on a physical NIC with SR-IOV support.). Value defaults to `VMXNET3`.
- `connected` (Boolean) Whether the network interface is connected or not. Value defaults to `true`.
- `ip` (String) The IP address to assign to this VM on this network. Must be a valid IP with net.ParseIP. If <.ip_allocation_mode attribute is set and the value is one of `"MANUAL"`, `"POOL"`, this attribute is REQUIRED. If <.ip_allocation_mode attribute is set and the value is one of `"DHCP"`, `"NONE"`, this attribute is NULL.
- `ip_allocation_mode` (String) The IP allocation mode for this network. Value must be one of: `DHCP` (IP address is obtained from a DHCP service.), `POOL` (Static IP address is allocated automatically from defined static pool in network.), `MANUAL` (SIP address is assigned manually in the ip field. Must be valid IP address from static pool.), `NONE` (No IP address will be set because VM will have a NIC without network.). Value defaults to `DHCP`.
- `is_primary` (Boolean) Whether this network is the primary network for the VM <a href="#restartrequired" style="color:red">(Restart Required)</a>. Value defaults to `false`.
- `mac` (String) The MAC address to assign to this VM on this network. Autogenerated if not specified. Must be a valid mac address.
- `name` (String) The name of the network to attach to the VM. If <.type attribute is set and the value is one of `"vapp"`, `"org"`, this attribute is REQUIRED. If <.type attribute is set and the value is one of `"none"`, this attribute is NULL.



<a id="nestedatt--settings"></a>
### Nested Schema for `settings`

Optional:

- `affinity_rule_id` (String) The ID of the affinity rule to apply to this VM.
- `customization` (Attributes) The customization settings for the VM. (see [below for nested schema](#nestedatt--settings--customization))
- `expose_hardware_virtualization` (Boolean) Whether to expose hardware CPU virtualization to the guest OS <a href="#restartrequired" style="color:red">(Restart Required)</a>. Value defaults to `false`.
- `guest_properties` (Map of String) Key/Value settings for guest properties.
- `os_type` (String) The type of OS installed on the VM <a href="#restartrequired" style="color:red">(Restart Required)</a>. Value must be one of: `amazonlinux2_64Guest` (Amazon Linux 2 (64-bit)), `asianux3Guest` (ASIANUX 3 (32-bit)), `asianux3_64Guest` (ASIANUX 3 (64-bit)), `asianux4Guest` (ASIANUX 4 (32-bit)), `asianux4_64Guest` (ASIANUX 4 (64-bit)), `asianux7_64Guest` (ASIANUX 7 (64-bit)), `asianux8_64Guest` (ASIANUX 8 (64-bit)), `centos64Guest` (CentOS Linux 5 (64-bit)), `centos6Guest` (CentOS Linux 6 (32-bit)), `centos6_64Guest` (CentOS Linux 6 (64-bit)), `centos7_64Guest` (CentOS Linux 7 (64-bit)), `centos8_64Guest` (CentOS Linux 8 (64-bit)), `centosGuest` (CentOS Linux 5 (32-bit)), `coreos64Guest` (CoreOS Linux (64-bit)), `darwin10Guest` (Apple macOS 10.6 (32-bit)), `darwin10_64Guest` (Apple macOS 10.6 (64-bit)), `darwin11Guest` (Apple macOS 10.7 (32-bit)), `darwin11_64Guest` (Apple macOS 10.7 (64-bit)), `darwin12_64Guest` (Apple macOS 10.8 (64-bit)), `darwin13_64Guest` (Apple macOS 10.9 (64-bit)), `darwin14_64Guest` (Apple macOS 10.10 (64-bit)), `darwin15_64Guest` (Apple macOS 10.11 (64-bit)), `darwin16_64Guest` (Apple macOS 10.12 (64-bit)), `darwin17_64Guest` (Apple macOS 10.13 (64-bit)), `darwin18_64Guest` (Apple macOS 10.14 (64-bit)), `debian10Guest` (Debian Linux 10 (32-bit)), `debian10_64Guest` (Debian Linux 10 (64-bit)), `debian4Guest` (Debian Linux 4 (32-bit)), `debian4_64Guest` (Debian Linux 4 (64-bit)), `debian5Guest` (Debian Linux 5 (32-bit)), `debian5_64Guest` (Debian Linux 5 (64-bit)), `debian6Guest` (Debian Linux 6 (32-bit)), `debian6_64Guest` (Debian Linux 6 (64-bit)), `debian7Guest` (Debian Linux 7 (32-bit)), `debian7_64Guest` (Debian Linux 7 (64-bit)), `debian8Guest` (Debian Linux 8 (32-bit)), `debian8_64Guest` (Debian Linux 8 (64-bit)), `debian9Guest` (Debian Linux 9 (32-bit)), `debian9_64Guest` (Debian Linux 9 (64-bit)), `dosGuest` (Microsoft MS-DOS), `eComStation2Guest` (Serenity Systems eComStation 2), `eComStationGuest` (Serenity Systems eComStation 1), `freebsd11Guest` (FreeBSD 11 (32-bit)), `freebsd11_64Guest` (FreeBSD 11 (64-bit)), `freebsd12Guest` (FreeBSD 12 or later versions (32-bit)), `freebsd12_64Guest` (FreeBSD 12 or later versions (64-bit)), `freebsd64Guest` (FreeBSD Pre-11 versions (64-bit)), `freebsdGuest` (FreeBSD Pre-11 versions (32-bit)), `netware5Guest` (Novell NetWare 5.x), `netware6Guest` (Novell NetWare 6.x), `oesGuest` (Novell Open Enterprise Server (32-bit)), `openServer5Guest` (SCO OpenServer 5), `openServer6Guest` (SCO OpenServer 6), `oracleLinux64Guest` (Oracle Linux 5 (64-bit)), `oracleLinux6Guest` (Oracle Linux 6 (32-bit)), `oracleLinux6_64Guest` (Oracle Linux 6 (64-bit)), `oracleLinux7_64Guest` (Oracle Linux 7 (64-bit)), `oracleLinux8_64Guest` (Oracle Linux 8 (64-bit)), `oracleLinuxGuest` (Oracle Linux 5 (32-bit)), `os2Guest` (IBM OS/2), `other24xLinux64Guest` (Other Linux 2.4.x (64-bit)), `other24xLinuxGuest` (Other Linux 2.4.x (32-bit)), `other26xLinux64Guest` (Other Linux 2.6.x (64-bit)), `other26xLinuxGuest` (Other Linux 2.6.x (32-bit)), `other3xLinux64Guest` (Other Linux 3.x (64-bit)), `other3xLinuxGuest` (Other Linux 3.x (32-bit)), `other4xLinux64Guest` (Other Linux 4.x (64-bit)), `other4xLinuxGuest` (Other Linux 4.x (32-bit)), `otherGuest` (Other (32-bit)), `otherGuest64` (Other (64-bit)), `otherLinux64Guest` (Other Linux (64-bit)), `otherLinuxGuest` (Other Linux (32-bit)), `rhel2Guest` (Red Hat Enterprise Linux 2 (32-bit)), `rhel3Guest` (Red Hat Enterprise Linux 3 (32-bit)), `rhel3_64Guest` (Red Hat Enterprise Linux 3 (64-bit)), `rhel4Guest` (Red Hat Enterprise Linux 4 (32-bit)), `rhel4_64Guest` (Red Hat Enterprise Linux 4 (64-bit)), `rhel5Guest` (Red Hat Enterprise Linux 5 (32-bit)), `rhel5_64Guest` (Red Hat Enterprise Linux 5 (64-bit)), `rhel6Guest` (Red Hat Enterprise Linux 6 (32-bit)), `rhel6_64Guest` (Red Hat Enterprise Linux 6 (64-bit)), `rhel7_64Guest` (Red Hat Enterprise Linux 7 (64-bit)), `rhel8_64Guest` (Red Hat Enterprise Linux 8 (64-bit)), `sles10Guest` (SUSE Linux Enterprise Server 10 (32-bit)), `sles10_64Guest` (SUSE Linux Enterprise Server 10 (64-bit)), `sles11Guest` (SUSE Linux Enterprise Server 11 (32-bit)), `sles11_64Guest` (SUSE Linux Enterprise Server 11 (64-bit)), `sles12_64Guest` (SUSE Linux Enterprise Server 12 (64-bit)), `sles15_64Guest` (SUSE Linux Enterprise Server 15 (64-bit)), `sles64Guest` (SUSE Linux Enterprise Server 11 (64-bit)), `slesGuest` (SUSE Linux Enterprise Server 11 (32-bit)), `solaris10Guest` (Oracle Solaris 10 (32-bit)), `solaris10_64Guest` (Oracle Solaris 10 (64-bit)), `solaris11_64Guest` (Oracle Solaris 11 (64-bit)), `ubuntu64Guest` (Ubuntu Linux 64-bit), `ubuntuGuest` (Ubuntu Linux 32-bit), `unixWare7Guest` (SCO UnixWare 7), `vmwarePhoton64Guest` (VMware Photon OS 64-bit), `win2000AdvServGuest` (Microsoft Windows 2000), `win2000ProGuest` (Microsoft Windows 2000 Professional), `win2000ServGuest` (Microsoft Windows 2000 Server), `win31Guest` (Microsoft Windows 3.1), `win95Guest` (Microsoft Windows 95), `win98Guest` (Microsoft Windows 98), `winLonghorn64Guest` (Microsoft Windows Server 2008 (64-bit)), `winLonghornGuest` (Microsoft Windows Server 2008 (32-bit)), `winNTGuest` (Microsoft Windows NT), `winNetBusinessGuest` (Microsoft Windows Small Business Server 2003), `winNetDatacenter64Guest` (Microsoft Windows Server 2003 Datacenter Edition (64-bit)), `winNetDatacenterGuest` (Microsoft Windows Server 2003 Datacenter Edition (32-bit)), `winNetEnterprise64Guest` (Microsoft Windows Server 2003 (64-bit)), `winNetEnterpriseGuest` (Microsoft Windows Server 2003 (32-bit)), `winNetStandard64Guest` (Microsoft Windows Server 2003 Standard Edition (64-bit)), `winNetStandardGuest` (Microsoft Windows Server 2003 Standard Edition (32-bit)), `winNetWebGuest` (Microsoft Windows Server 2003 Web Edition (32-bit)), `winVista64Guest` (Microsoft Windows Vista (64-bit)), `winVistaGuest` (Microsoft Windows Vista (32-bit)), `winXPPro64Guest` (Microsoft Windows XP Professional (64-bit)), `winXPProGuest` (Microsoft Windows XP Professional (32-bit)), `windows7Guest` (Microsoft Windows 7 (32-bit)), `windows7Server64Guest` (Microsoft Windows Server 2008 R2 (64-bit)), `windows7_64Guest` (Microsoft Windows 7 (64-bit)), `windows8Guest` (Microsoft Windows 8.x (32-bit)), `windows8Server64Guest` (Microsoft Windows Server 2012 (64-bit)), `windows8_64Guest` (Microsoft Windows 8.x (64-bit)), `windows9Guest` (Microsoft Windows 10 (32-bit)), `windows9_64Guest` (Microsoft Windows 10 (64-bit)).
- `storage_profile` (String) The storage profile to use. Value must be one of : `silver`, `silver_r1`, `silver_r2`, `gold`, `gold_r1`, `gold_r2`, `gold_hm`, `platinum3k`, `platinum3k_r1`, `platinum3k_r2`, `platinum3k_hm`, `platinum7k`, `platinum7k_r1`, `platinum7k_r2`, `platinum7k_hm`.

<a id="nestedatt--settings--customization"></a>
### Nested Schema for `settings.customization`

Optional:

- `admin_password` (String, Sensitive) The admin password for the VM. Ensure that if an attribute is set, these are not set: "[<.auto_generate_password]".
- `allow_local_admin_password` (Boolean) Whether to allow the local admin password to be changed. Value defaults to `false`.
- `auto_generate_password` (Boolean) Whether to auto-generate the password. Ensure that if an attribute is set, these are not set: "[<.admin_password]".
- `change_sid` (Boolean) Whether to change the SID of the VM. Applicable only for Windows VMs. Value defaults to `false`.
- `enabled` (Boolean) Whether guest customization is enabled or not. Value defaults to `false`.
- `force` (Boolean) `true` value will cause the VM to reboot on every `apply` operation. Value defaults to `false`.
- `hostname` (String) Computer name to assign to this virtual machine. Default is the value of attribute `name`. Must be between 1 and 80 characters long and can contain only letters, numbers and hyphen. It must not contain only digits.
- `init_script` (String) The init script to run.
- `join_domain` (Boolean) Enable this VM to join a domain. Value defaults to `false`.
- `join_domain_account_ou` (String) The domain account OU to join.
- `join_domain_name` (String) The domain name to join.
- `join_domain_password` (String, Sensitive) The domain password to join.
- `join_domain_user` (String) The domain user to join.
- `join_org_domain` (Boolean) Use organization's domain for joining. Value defaults to `false`.
- `must_change_password_on_first_login` (Boolean) Whether the password must be changed on first login. Value defaults to `false`.
- `number_of_auto_logons` (Number) The number of times the VM should auto-login. Value must be at least 0.



<a id="nestedatt--state"></a>
### Nested Schema for `state`

Optional:

- `power_on` (Boolean) Whether the VM should be powered on or not. `true` means powered on, `false` means powered off. Value defaults to `true`.

Read-Only:

- `status` (String) The status of the VM.

## Import

Import is supported using the following syntax:
```shell
# If `vDC` is not specified, the default `vDC` will be used
# The `myVMID` is the ID of the VM. 
terraform import cloudavenue_vm.example myVAPP.myVMID

# or you can specify the vDC
terraform import cloudavenue_vm.example myVDC.myVAPP.myVMID
```

<a id="advanced--examples"></a>
## Advanced Examples


### VM with Network

This example shows how to create a VM from a vApp template connected to a routed network.

```hcl
data "cloudavenue_tier0_vrfs" "example" {}

resource "cloudavenue_edgegateway" "example" {
  owner_name     = "example-vdc"
  tier0_vrf_name = data.cloudavenue_tier0_vrfs.example.names.0
  owner_type     = "vdc"
}

resource "cloudavenue_network_routed" "example" {
  name        = "example-network"
  description = "This is an example Net"
  edge_gateway_id = cloudavenue_edgegateway.example.id
  gateway       = "192.168.1.254"
  prefix_length = 24
  dns1 = "1.1.1.1"
  dns2 = "8.8.8.8"
  dns_suffix = "example"
  static_ip_pool = [
    {
      start_address = "192.168.1.10"
      end_address   = "192.168.1.20"
    }
  ]
}

resource "cloudavenue_vapp" "example" {
  name        = "example-vapp"
  description = "This is an example vApp"
}

resource "cloudavenue_vapp_org_network" "example" {
  vapp_name    = cloudavenue_vapp.example.name
  network_name = cloudavenue_network_routed.example.name
}

resource "cloudavenue_vm" "example" {
  name      = "example-vm"
  vapp_name = cloudavenue_vapp.example.name
  deploy_os = {
    vapp_template_id = data.cloudavenue_catalog_vapp_template.example.id
  }
  settings = {
    guest_properties = {
      "guestinfo.hostname" = "example-vm"
    }
    customization = {
      auto_generate_password = true
    }
  }
  resource = {
    cpus   = 2
    memory = 2048
    networks = [
      {
        type               = "org"
        name               = cloudavenue_vapp_org_network.example.network_name
        ip                 = "192.168.1.11"
        ip_allocation_mode = "MANUAL"
        is_primary         = true
      }
    ]
  }
}
```